#########################################
#
# Regressors
#
# Written by ViolentBeetle
#
#########################################

namespace = mem_regressors
@tier1influencecontact = 7
@tier1influencecontactxenophile = 8
@tier1influencecontactmin = 20
@tier1influencecontactmax = 80

@tier2influencecontact = 10
@tier2influencecontactxenophile = 12
@tier2influencecontactmin = 40
@tier2influencecontactmax = 100

@tier1materialreward = 6
@tier1materialmin = 100
@tier1materialmax = 500
@tier2materialreward = 12
@tier2materialmin = 150
@tier2materialmax = 1000
@tier3materialreward = 18
@tier3materialmin = 250
@tier3materialmax = 1500
@tier4materialreward = 24
@tier4materialmin = 350
@tier4materialmax = 2000
@tier5materialreward = 48
@tier5materialmin = 700
@tier5materialmax = 4000

@tier1influencereward = 6
@tier1influencemin = 40
@tier1influencemax = 100
@tier2influencereward = 12
@tier2influencemin = 80
@tier2influencemax = 175
@tier3influencereward = 18
@tier3influencemin = 125
@tier3influencemax = 250
@tier4influencereward = 24
@tier4influencemin = 150
@tier4influencemax = 300
@tier5influencereward = 36
@tier5influencemin = 250
@tier5influencemax = 500
@tier6influencereward = 48
@tier6influencemin = 300
@tier6influencemax = 600

@tier1researchreward = 6
@tier1researchmin = 60
@tier1researchmax = 150
@tier2researchreward = 12
@tier2researchmin = 90
@tier2researchmax = 250
@tier3researchreward = 18
@tier3researchmin = 120
@tier3researchmax = 350
@tier4researchreward = 24
@tier4researchmin = 150
@tier4researchmax = 500
@tier5researchreward = 48
@tier5researchmin = 300
@tier5researchmax = 1000

#Seeding galaxy with primitives
event = {
	id = mem_regressors.1
	
	hide_window = yes
	
	is_triggered_only = yes
	
	fire_only_once = yes
	
	# trigger = {
		# count_countries = { # We need to spare some
			# limit = {
				# is_country_type = primitive
				# NOT = {
					# capital_scope = {
						# solar_system = { has_star_flag = sol }
					# }
				# }
				# OR = {
					# has_country_flag = stone_age
					# has_country_flag = bronze_age
					# has_country_flag = iron_age
					# has_country_flag = late_medieval_age
					# has_country_flag = renaissance_age
					# has_country_flag = steam_age
					# has_country_flag = industrial_age
					# has_country_flag = machine_age
					# has_country_flag = atomic_age
					# has_country_flag = early_space_age
				# }
			# }
			# count > 7
		# }
	# }

	immediate = {
		random_country = {
			limit = {
				is_country_type = primitive
				NOT = { has_ethic = ethic_hive_mind }
				NOT = {
					capital_scope = {
						solar_system = { has_star_flag = sol }
					}
				}
				OR = {
					has_country_flag = stone_age
					has_country_flag = bronze_age
					has_country_flag = iron_age
					has_country_flag = late_medieval_age
					has_country_flag = renaissance_age
					has_country_flag = steam_age
					has_country_flag = industrial_age
					has_country_flag = machine_age
					has_country_flag = atomic_age
					has_country_flag = early_space_age
				}
			}
			save_event_target_as = first_civ
			
			change_government = {
				authority = auth_dictatorial
				civics = {
					civic = civic_mem_war_is_peace
					civic = civic_mem_freedom_is_slavery
				}
			}
			change_country_flag = {
				icon = {
					category = "special"
					file = "primitive.dds"
				}
				background= {
					category = "backgrounds"
					file = "00_solid.dds"
				}
				colors = {
					"black"
					"black"
					"null"
					"null"
				}
			}
			
			#Ethic blanket cleanup
			country_remove_ethic = ethic_xenophile
			country_remove_ethic = ethic_xenophobe
			country_remove_ethic = ethic_pacifist
			country_remove_ethic = ethic_militarist
			country_remove_ethic = ethic_materialist
			country_remove_ethic = ethic_spiritualist
			country_remove_ethic = ethic_authoritarian
			country_remove_ethic = ethic_egalitarian
			country_remove_ethic = ethic_fanatic_xenophile
			country_remove_ethic = ethic_fanatic_xenophobe
			country_remove_ethic = ethic_fanatic_pacifist
			country_remove_ethic = ethic_fanatic_militarist
			country_remove_ethic = ethic_fanatic_materialist
			country_remove_ethic = ethic_fanatic_spiritualist
			country_remove_ethic = ethic_fanatic_authoritarian
			country_remove_ethic = ethic_fanatic_egalitarian
			
			# country_add_ethic = ethic_xenophobe
			country_add_ethic = ethic_militarist
			country_add_ethic = ethic_fanatic_authoritarian
			
			#Cleanup from vanilla
			remove_country_flag = stone_age
			remove_country_flag = bronze_age
			remove_country_flag = iron_age
			remove_country_flag = late_medieval_age
			remove_country_flag = renaissance_age
			remove_country_flag = steam_age
			remove_country_flag = industrial_age
			remove_country_flag = machine_age
			remove_country_flag = atomic_age
			remove_country_flag = early_space_age
			every_owned_fleet = {
				destroy_fleet = this
			}
			every_owned_army = {
				remove_army = yes
			}
			set_graphical_culture = industrial_01
			
			set_country_flag = mem_regressors_first_civ
			set_country_flag = mem_regressors_post_inflection
			set_primitive_age = mem_regressors_post_inflection
			
			capital_scope = {
				every_tile = {
					limit = { has_building = yes }
					remove_building = yes
				}
				every_tile = {
					limit = { has_blocker = yes }
					remove_blocker = yes
				}
				while = {
					count = 2
					random_tile = {
						limit = { has_blocker = no }
						set_blocker = tb_failing_infrastructure
					}
					random_tile = {
						limit = { has_blocker = no }
						set_blocker = tb_decrepit_dwellings
					}
					random_tile = {
						limit = { has_blocker = no }
						set_blocker = tb_crater
					}
				}
				every_tile = {
					limit = { has_pop = no has_blocker = no }
					create_pop = {
						species = owner
					}
				}
				every_owned_pop = {
					random_list = {
						# 33 = { pop_change_ethic = ethic_xenophobe }
						66 = { pop_change_ethic = ethic_authoritarian }
						33 = { pop_change_ethic = ethic_militarist }
					}
				}
				while = {
					count = 6
					create_army = {
						name = "NAME_Industrial_Army"
						owner = prev
						species = prev
						type = "industrial_army"
					}
				}
				while = {
					count = 3
					random_tile = {
						limit = { has_blocker = no has_building = no }
						set_building = mem_regressors_ministry
						clear_deposits = yes
					}
				}
				while = {
					limit = {
						any_tile = { has_blocker = no has_building = no }
					}
					random_tile = {
						limit = { has_blocker = no has_building = no }
						set_building = building_primitive_farm
						add_resource = {
							resource = food
							amount = 1
							replace = yes
						}
					}
					random_tile = {
						limit = { has_blocker = no has_building = no }
						set_building = building_primitive_factory
						add_resource = {
							resource = minerals
							amount = 1
							replace = yes
						}
					}
				}
				every_tile = {
					limit = { has_blocker = yes }
					clear_deposits = yes
				}
				
				solar_system = {
					set_star_flag = mem_regressors_first_solar_system
					set_star_flag = mem_regressors_pi_system
					save_event_target_as = first_system
				}
			}
		}
		
		event_target:first_system = {
			#Picking second civ
			closest_system = {
				limit = {
					NOT = { has_star_flag = mem_regressors_pi_system }
					NOT = { has_star_flag = sol }
					any_planet = {
						has_owner = yes
						owner = {
							is_country_type = primitive
							OR = {
								has_country_flag = stone_age
								has_country_flag = bronze_age
								has_country_flag = iron_age
								has_country_flag = late_medieval_age
								has_country_flag = renaissance_age
								has_country_flag = steam_age
								has_country_flag = industrial_age
								has_country_flag = machine_age
								has_country_flag = atomic_age
								has_country_flag = early_space_age
							}
						}
					}
				}
				
				set_star_flag = mem_regressors_second_solar_system
				set_star_flag = mem_regressors_pi_system
				save_event_target_as = second_system
				random_system_planet = {
					limit = {
						has_owner = yes
						owner = {
							is_country_type = primitive
							OR = {
								has_country_flag = stone_age
								has_country_flag = bronze_age
								has_country_flag = iron_age
								has_country_flag = late_medieval_age
								has_country_flag = renaissance_age
								has_country_flag = steam_age
								has_country_flag = industrial_age
								has_country_flag = machine_age
								has_country_flag = atomic_age
								has_country_flag = early_space_age
							}
						}
					}
					owner = {
						save_event_target_as = second_civ
					}
				}
			}
			
			#Picking third civ
			closest_system = {
				limit = {
					NOT = { has_star_flag = mem_regressors_pi_system }
					NOT = { has_star_flag = sol }
					any_planet = {
						has_owner = yes
						owner = {
							is_country_type = primitive
							OR = {
								has_country_flag = stone_age
								has_country_flag = bronze_age
								has_country_flag = iron_age
								has_country_flag = late_medieval_age
								has_country_flag = renaissance_age
								has_country_flag = steam_age
								has_country_flag = industrial_age
								has_country_flag = machine_age
								has_country_flag = atomic_age
								has_country_flag = early_space_age
							}
						}
					}
				}
				
				set_star_flag = mem_regressors_third_solar_system
				set_star_flag = mem_regressors_pi_system
				save_event_target_as = third_system
				random_system_planet = {
					limit = {
						has_owner = yes
						owner = {
							is_country_type = primitive
							OR = {
								has_country_flag = stone_age
								has_country_flag = bronze_age
								has_country_flag = iron_age
								has_country_flag = late_medieval_age
								has_country_flag = renaissance_age
								has_country_flag = steam_age
								has_country_flag = industrial_age
								has_country_flag = machine_age
								has_country_flag = atomic_age
								has_country_flag = early_space_age
							}
						}
					}
					owner = {
						save_event_target_as = third_civ
					}
				}
			}
		}
		
		#OK, we done here, transforming second civ
		event_target:second_civ = {
			change_government = {
				authority = auth_oligarchic
				civics = {
					civic = civic_mem_rentier_capitalism
					civic = civic_mem_degenerate_elites
				}
			}
			change_country_flag = {
				icon = {
					category = "special"
					file = "primitive.dds"
				}
				background= {
					category = "backgrounds"
					file = "00_solid.dds"
				}
				colors = {
					"dark_green"
					"dark_green"
					"null"
					"null"
				}
			}
			
			#Ethic blanket cleanup
			country_remove_ethic = ethic_xenophile
			country_remove_ethic = ethic_xenophobe
			country_remove_ethic = ethic_pacifist
			country_remove_ethic = ethic_militarist
			country_remove_ethic = ethic_materialist
			country_remove_ethic = ethic_spiritualist
			country_remove_ethic = ethic_authoritarian
			country_remove_ethic = ethic_egalitarian
			country_remove_ethic = ethic_fanatic_xenophile
			country_remove_ethic = ethic_fanatic_xenophobe
			country_remove_ethic = ethic_fanatic_pacifist
			country_remove_ethic = ethic_fanatic_militarist
			country_remove_ethic = ethic_fanatic_materialist
			country_remove_ethic = ethic_fanatic_spiritualist
			country_remove_ethic = ethic_fanatic_authoritarian
			country_remove_ethic = ethic_fanatic_egalitarian
			
			# country_add_ethic = ethic_xenophobe
			country_add_ethic = ethic_authoritarian
			country_add_ethic = ethic_fanatic_materialist
			
			#Cleanup from vanilla
			remove_country_flag = stone_age
			remove_country_flag = bronze_age
			remove_country_flag = iron_age
			remove_country_flag = late_medieval_age
			remove_country_flag = renaissance_age
			remove_country_flag = steam_age
			remove_country_flag = industrial_age
			remove_country_flag = machine_age
			remove_country_flag = atomic_age
			remove_country_flag = early_space_age
			every_owned_fleet = {
				destroy_fleet = this
			}
			every_owned_army = {
				remove_army = yes
			}
			set_graphical_culture = industrial_01
			
			set_country_flag = mem_regressors_second_civ
			set_country_flag = mem_regressors_post_inflection
			set_primitive_age = mem_regressors_post_inflection
			
			capital_scope = {
				every_tile = {
					limit = { has_building = yes }
					remove_building = yes
				}
				every_tile = {
					limit = { has_blocker = yes }
					remove_blocker = yes
				}
				while = {
					count = 3
					random_tile = {
						limit = { has_blocker = no }
						set_blocker = tb_failing_infrastructure
					}
					random_tile = {
						limit = { has_blocker = no }
						set_blocker = tb_decrepit_dwellings
					}
				}
				every_tile = {
					limit = { has_pop = no has_blocker = no }
					create_pop = {
						species = owner
					}
				}
				every_owned_pop = {
					random_list = {
						# 33 = { pop_change_ethic = ethic_xenophobe }
						66 = { pop_change_ethic = ethic_materialist }
						33 = { pop_change_ethic = ethic_authoritarian }
					}
				}
				while = {
					count = 6
					create_army = {
						name = "Corporate Mercenaries"
						owner = prev
						species = prev
						type = "industrial_army"
					}
				}
				while = {
					count = 3
					random_tile = {
						limit = { has_blocker = no has_building = no }
						set_building = mem_regressors_corporate_hq
						clear_deposits = yes
					}
				}
				while = {
					limit = {
						any_tile = { has_blocker = no has_building = no }
					}
					random_tile = {
						limit = { has_blocker = no has_building = no }
						set_building = building_primitive_farm
						add_resource = {
							resource = food
							amount = 1
							replace = yes
						}
					}
					random_tile = {
						limit = { has_blocker = no has_building = no }
						set_building = building_primitive_factory
						add_resource = {
							resource = minerals
							amount = 1
							replace = yes
						}
					}
				}
				every_tile = {
					limit = { has_blocker = yes }
					clear_deposits = yes
				}
			}
		}
		
		#Transforming the third civ
		event_target:third_civ = {
			change_government = {
				authority = auth_oligarchic
				civics = {
					civic = civic_mem_relentless_hedonism
					civic = civic_mem_happiness_in_lobotomy
				}
			}
			change_country_flag = {
				icon = {
					category = "special"
					file = "primitive.dds"
				}
				background= {
					category = "backgrounds"
					file = "00_solid.dds"
				}
				colors = {
					"pink"
					"pink"
					"null"
					"null"
				}
			}
			
			#Ethic blanket cleanup
			country_remove_ethic = ethic_xenophile
			country_remove_ethic = ethic_xenophobe
			country_remove_ethic = ethic_pacifist
			country_remove_ethic = ethic_militarist
			country_remove_ethic = ethic_materialist
			country_remove_ethic = ethic_spiritualist
			country_remove_ethic = ethic_authoritarian
			country_remove_ethic = ethic_egalitarian
			country_remove_ethic = ethic_fanatic_xenophile
			country_remove_ethic = ethic_fanatic_xenophobe
			country_remove_ethic = ethic_fanatic_pacifist
			country_remove_ethic = ethic_fanatic_militarist
			country_remove_ethic = ethic_fanatic_materialist
			country_remove_ethic = ethic_fanatic_spiritualist
			country_remove_ethic = ethic_fanatic_authoritarian
			country_remove_ethic = ethic_fanatic_egalitarian
			
			# country_add_ethic = ethic_xenophobe
			country_add_ethic = ethic_pacifist
			country_add_ethic = ethic_fanatic_materialist
			
			#Cleanup from vanilla
			remove_country_flag = stone_age
			remove_country_flag = bronze_age
			remove_country_flag = iron_age
			remove_country_flag = late_medieval_age
			remove_country_flag = renaissance_age
			remove_country_flag = steam_age
			remove_country_flag = industrial_age
			remove_country_flag = machine_age
			remove_country_flag = atomic_age
			remove_country_flag = early_space_age
			every_owned_fleet = {
				destroy_fleet = this
			}
			every_owned_army = {
				remove_army = yes
			}
			set_graphical_culture = industrial_01
			
			set_country_flag = mem_regressors_third_civ
			set_country_flag = mem_regressors_post_inflection
			set_primitive_age = mem_regressors_post_inflection
			
			capital_scope = {
				every_tile = {
					limit = { has_building = yes }
					remove_building = yes
				}
				every_tile = {
					limit = { has_blocker = yes }
					remove_blocker = yes
				}
				while = {
					count = 6
					random_tile = {
						limit = { has_blocker = no }
						set_blocker = tb_failing_infrastructure
					}
				}
				every_tile = {
					limit = { has_pop = no has_blocker = no }
					create_pop = {
						species = owner
					}
				}
				every_owned_pop = {
					random_list = {
						# 33 = { pop_change_ethic = ethic_xenophobe }
						66 = { pop_change_ethic = ethic_materialist }
						33 = { pop_change_ethic = ethic_pacifist }
					}
				}
				while = {
					count = 6
					create_army = {
						name = "Peacekeepers"
						owner = prev
						species = prev
						type = "industrial_army"
					}
				}
				random_tile = {
					limit = { has_blocker = no has_building = no }
					set_building = building_agri_processing_complex
					clear_deposits = yes
				}
				random_tile = {
					limit = { has_blocker = no has_building = no }
					set_building = building_ancient_factory
					clear_deposits = yes
				}
				
				every_tile = {
					limit = { has_blocker = no has_building = no }
					set_building = mem_regressors_pleasure_dome
					clear_deposits = yes
				}
				every_tile = {
					limit = { has_blocker = yes }
					clear_deposits = yes
				}
			}
		}
		random_country = {
			limit = { is_ai = no }
			country_event = {
				id = mem_regressors.1000
				days = 1
			}
		}
	}
}

#Debag greetings event
country_event = {
	id = mem_regressors.1000
	title = mem_regressors.1000.name
	desc = mem_regressors.1000.desc
	
	is_triggered_only = yes
	
	picture = GFX_evt_alien_city
	
	option = {
		name = mem_regressors.1000.a
		
		create_point_of_interest = {
			id = mem_regressors_poi.1
			name = "FIRST"
			desc = "FIRST"
			location = event_target:first_system
		}
		create_point_of_interest = {
			id = mem_regressors_poi.2
			name = "SECOND"
			desc = "SECOND"
			location = event_target:second_system
		}
		create_point_of_interest = {
			id = mem_regressors_poi.3
			name = "THIRD"
			desc = "THIRD"
			location = event_target:third_system
		}
	}
	
	option = {
		name = mem_regressors.1000.b
	}
}